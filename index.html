<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>💧 Water Mission - Charity: Water Game</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="with-bg">
    <!-- Parallax background layers (back, mid, front) -->
    <div class="parallax-bg" aria-hidden="true">
        <div class="parallax-layer" data-depth="0.2"><img src="assets/bg-water-back.svg" alt=""/></div>
        <div class="parallax-layer" data-depth="0.5"><img src="assets/bg-water-mid.svg" alt=""/></div>
        <div class="parallax-layer" data-depth="0.9"><img src="assets/bg-water-front.svg" alt=""/></div>
    </div>

    <div class="game-container">
        <div class="game-wrapper">
            <!-- Header -->
            <div class="header">
                <h1>💧 Water Mission</h1>
                <p>Help charity: water deliver clean water to communities in need!</p>
            </div>

            <!-- Game Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">🏆</div>
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🛢️</div>
                    <div class="stat-label">Jerry Cans</div>
                    <div class="stat-value jerry-cans" id="jerryCanCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">👥</div>
                    <div class="stat-label">People Served</div>
                    <div class="stat-value people-served" id="peopleServed">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🚛</div>
                    <div class="stat-label">Trail Length</div>
                    <div class="stat-value" id="trailLength">1</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🥇</div>
                    <div class="stat-label">High Score</div>
                    <div class="stat-value" id="highScore">0</div>
                </div>
            </div>

            <!-- Milestone Badge -->
            <div class="milestone-container" id="milestoneContainer" style="display: none;">
                <div class="milestone-badge" id="milestoneBadge"></div>
            </div>

            <!-- Feedback Message -->
            <div class="feedback-container" id="feedbackContainer" style="display: none;">
                <div class="feedback-message" id="feedbackMessage"></div>
            </div>

            <!-- Game Canvas -->
            <div class="game-canvas-container">
                <div class="game-canvas" id="gameCanvas">
                        <canvas id="gameCanvas" width="600" height="400"></canvas>
                    </div>
            </div>

            <!-- Controls -->
            <div class="controls-section">
                <!-- Start Screen -->
                <div class="start-screen" id="startScreen">
                    <div class="mode-select">
                        <button class="mode-button selected" data-mode="easy" id="modeEasy" title="Easy: fewer pollutants, small penalty"><img class="mode-icon" src="assets/icon-easy.svg" alt="easy icon"><span>Easy</span></button>
                        <button class="mode-button" data-mode="medium" id="modeMedium" title="Medium: more pollutants, larger penalty"><img class="mode-icon" src="assets/icon-medium.svg" alt="medium icon"><span>Medium</span></button>
                        <button class="mode-button" data-mode="hard" id="modeHard" title="Hard: medium rules + faster truck"><img class="mode-icon" src="assets/icon-hard.svg" alt="hard icon"><span>Hard</span></button>
                    </div>
                        <div class="sound-controls">
                            <label><input type="checkbox" id="soundToggle" checked> Sound</label>
                            <label>Volume <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="0.06"></label>
                            <label title="Disable background motion if you prefer reduced motion"><input type="checkbox" id="parallaxToggle"> Parallax</label>
                        </div>
                    <button class="start-button" id="startButton">🚛 Start Water Mission</button>
                    <div style="margin-top:0.6rem; display:flex; justify-content:center; gap:0.6rem; align-items:center;">
                        <a href="#" id="showTutorialLink" class="muted-link">Show Tutorial</a>
                    </div>
                </div>

                    <!-- Tutorial Modal -->
                    <div class="tutorial-modal" id="tutorialModal" aria-hidden="true" style="display:none;">
                        <div class="tutorial-card" role="dialog" aria-label="Game tutorial">
                            <header class="tutorial-header">
                                <h3>Quick Tutorial</h3>
                            </header>
                            <div class="tutorial-steps">
                                <div class="step">
                                    <div class="step-icon">🚛</div>
                                    <div class="step-text"><strong>Drive</strong><div class="muted">Use the arrow keys to steer the truck.</div></div>
                                </div>
                                <div class="step">
                                    <div class="step-icon">💧</div>
                                    <div class="step-text"><strong>Collect</strong><div class="muted">Pick up water drops to add jerry cans and score points.</div></div>
                                </div>
                                <div class="step">
                                    <div class="step-icon">☠️</div>
                                    <div class="step-text"><strong>Avoid</strong><div class="muted">Don't hit pollution — it reduces your score.</div></div>
                                </div>
                            </div>
                            <div class="tutorial-actions">
                                <button id="closeTutorialPrimary" class="start-button small">Got it</button>
                                <button class="start-button small" onclick="openTutorial();" aria-label="Open tutorial again" style="display:none;">Open</button>
                            </div>
                        </div>
                    </div>

                <!-- Game Over Screen -->
                <div class="game-over-screen" id="gameOverScreen" style="display: none;">
                    <div class="results-box">
                        <h3>Mission Results</h3>
                        <p>You collected <strong id="finalJerryCans">0</strong> jerry cans</p>
                        <p>Providing clean water to <strong id="finalPeopleServed">0</strong> people!</p>
                    </div>
                    <div class="share-controls">
                        <button class="share-button" id="shareButton">📣 Share your score</button>
                        <button class="restart-button" id="restartButton">🔄 Try Another Mission</button>
                    </div>
                </div>

                <!-- Share Modal -->
                <div class="share-modal" id="shareModal" style="display:none;">
                    <div class="share-content">
                        <h3>Share your mission!</h3>
                        <p id="shareText">I just scored <strong id="shareScore">0</strong> points in Water Mission to support charity: water — help bring clean water! 👉 https://www.charitywater.org</p>
                        <div class="share-actions">
                            <button id="copyShare">Copy Message</button>
                            <button id="openLink">Open charity: water</button>
                            <button id="closeShare">Close</button>
                        </div>
                    </div>
                </div>

                <!-- Playing Instructions -->
                <div class="playing-instructions" id="playingInstructions" style="display: none;">
                    <p>Use ⬅️ ➡️ ⬆️ ⬇️ arrow keys to navigate your truck</p>
                    <p>Collect 💧 water drops to add jerry cans to your trail</p>
                </div>
            </div>

            <!-- About Section -->
            <div class="about-section">
                <div>
                    <h4>About charity: water</h4>
                    <p>charity: water is a non-profit bringing clean and safe drinking water to people in developing countries. Every jerry can you collect in this game represents impact — helping families access safe water for drinking, cooking, and sanitation.</p>
                </div>
                <div class="about-cta">
                    <div class="about-figure">
                        <img src="assets/jerry-can.svg" alt="jerry can">
                    </div>
                    <a href="https://www.charitywater.org" target="_blank" rel="noopener">Learn more / Donate</a>
                </div>
            </div>
        </div>
    </div>

        <script src="game.js"></script>
</body>
</html>